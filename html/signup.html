<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Foodie - Login & Sign Up</title>
    <link rel="stylesheet" href="../CSS/signUp.css" />
    <link rel="icon" href="../imgs/fabicon.png" type="image/png" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css"
      integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <script src="https://accounts.google.com/gsi/client" async defer></script>
  </head>

  <body>
    <a href="../HTML/index.html" class="back-home" aria-label="Back to Home">
      <span class="icon">‚Üê</span>
      Back to Home
    </a>

    <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode">
      <i class="fa-solid fa-moon"></i>
    </button>

    <div class="container">
      <div class="hero-section">
        <div class="logo">Foodie.</div>
        <div class="hero-text">
          We will fill your tummy with delicious food with fast delivery
        </div>
        <div class="pizza-icon">üçï</div>
      </div>

      <div class="form-section">
        <!-- Login Form -->
        <div id="loginForm" class="auth-container active">
          <h2>Welcome Back</h2>
          <p class="subtitle">Login to your account to continue ordering</p>

          <div class="social-login">
            <div id="loginGoogleBtn"></div>
          </div>

          <div class="divider">
            <span>OR</span>
          </div>

          <form onsubmit="handleLogin(event)">
            <div class="form-group">
              <label for="loginEmail">Email Address</label>
              <input
                type="email"
                id="loginEmail"
                placeholder="your@email.com"
                required
              />
            </div>

            <div class="form-group">
              <label for="loginPassword">Password</label>
              <div class="password-field">
                <input
                  type="password"
                  id="loginPassword"
                  placeholder="Enter your password"
                  required
                />
                <button
                  type="button"
                  class="toggle-password"
                  onclick="togglePassword('loginPassword')"
                >
                  üëÅÔ∏è
                </button>
              </div>
            </div>

            <div class="forgot-password">
              <a
                href="#"
                onclick="alert('Password reset feature coming soon!'); return false;"
                >Forgot Password?</a
              >
            </div>

            <div class="checkbox-group">
              <input type="checkbox" id="rememberMe" />
              <label for="rememberMe">Remember me</label>
            </div>

            <button type="submit" class="btn">Login</button>
          </form>

          <div class="switch-form">
            Don't have an account? <a onclick="switchForm('signup')">Sign Up</a>
          </div>
        </div>

        <!-- Sign Up Form -->
        <div id="signupForm" class="auth-container">
          <h2>Create Account</h2>
          <p class="subtitle">Sign up to start ordering delicious food</p>

          <div class="social-login">
            <div id="signupGoogleBtn"></div>
          </div>

          <div class="divider">
            <span>OR</span>
          </div>

          <form onsubmit="handleSignup(event)">
            <div class="form-group">
              <label for="signupName">Full Name</label>
              <input
                type="text"
                id="signupName"
                placeholder="John Doe"
                required
              />
            </div>

            <div class="form-group">
              <label for="signupEmail">Email Address</label>
              <input
                type="email"
                id="signupEmail"
                placeholder="your@email.com"
                required
              />
            </div>

            <div class="form-group">
              <label for="signupPhone">Phone Number</label>
              <input
                type="tel"
                id="signupPhone"
                placeholder="+91 12345 67890"
                required
              />
            </div>

            <div class="form-group">
              <label for="signupPassword">Password</label>
              <div class="password-field">
                <input
                  type="password"
                  id="signupPassword"
                  placeholder="Create a password"
                  required
                />
                <button
                  type="button"
                  class="toggle-password"
                  onclick="togglePassword('signupPassword')"
                >
                  üëÅÔ∏è
                </button>
              </div>
            </div>

            <div class="checkbox-group">
              <input type="checkbox" id="agreeTerms" required />
              <label for="agreeTerms">I agree to the Terms & Conditions</label>
            </div>

            <button type="submit" class="btn">Create Account</button>
          </form>

          <div class="switch-form">
            Already have an account? <a onclick="switchForm('login')">Login</a>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Initializing Google Sign-In buttons for both forms
      window.onload = function () {
        if (window.google && google.accounts && google.accounts.id) {
          google.accounts.id.initialize({
            client_id: "YOUR_GOOGLE_CLIENT_ID",
            callback: handleGoogleLogin,
            ux_mode: "popup",
          });

          google.accounts.id.renderButton(document.getElementById("loginGoogleBtn"), {
            theme: "outline",
            size: "large",
            text: "signin_with",
            shape: "rectangular",
            logo_alignment: "left",
          });

          google.accounts.id.renderButton(document.getElementById("signupGoogleBtn"), {
            theme: "outline",
            size: "large",
            text: "signup_with",
            shape: "rectangular",
            logo_alignment: "left",
          });
        }
      };

      function switchForm(formType) {
        const loginForm = document.getElementById("loginForm");
        const signupForm = document.getElementById("signupForm");

        if (formType === "login") {
          signupForm.classList.remove("active");
          loginForm.classList.add("active");
        } else {
          loginForm.classList.remove("active");
          signupForm.classList.add("active");
        }
      }

      function togglePassword(inputId) {
        const input = document.getElementById(inputId);
        const button = input.nextElementSibling;

        if (input.type === "password") {
          input.type = "text";
          button.textContent = "üôà";
        } else {
          input.type = "password";
          button.textContent = "üëÅÔ∏è";
        }
      }

      function handleLogin(event) {
        event.preventDefault();
        const email = document.getElementById("loginEmail").value;
        alert(`Welcome back! Logging in with: ${email}`);
      }

      function handleSignup(event) {
        event.preventDefault();
        const name = document.getElementById("signupName").value;
        const email = document.getElementById("signupEmail").value;
        alert(`Account created successfully for: ${name} (${email})`);
      }

      function handleGoogleLogin(response) {
        const data = parseJwt(response.credential);
        alert(`Welcome, ${data.name}! Logged in via Google.`);
        console.log("User details:", data);
      }

      function parseJwt(token) {
        const base64Url = token.split(".")[1];
        const base64 = base64Url.replace(/-/g, "+").replace(/_/g, "/");
        const jsonPayload = decodeURIComponent(
          atob(base64)
            .split("")
            .map(function (c) {
              return "%" + ("00" + c.charCodeAt(0).toString(16)).slice(-2);
            })
            .join("")
        );
        return JSON.parse(jsonPayload);
      }

      (function () {
        const root = document.documentElement;
        const btn = document.getElementById("themeToggle");

        function apply(theme) {
          if (theme === "dark") {
            root.setAttribute("data-theme", "dark");
            btn.innerHTML = '<i class="fa-solid fa-sun"></i>';
          } else {
            root.removeAttribute("data-theme");
            btn.innerHTML = '<i class="fa-solid fa-moon"></i>';
          }
          localStorage.setItem("theme", theme);
        }

        const saved = localStorage.getItem("theme");
        const prefersDark =
          window.matchMedia &&
          window.matchMedia("(prefers-color-scheme: dark)").matches;

        apply(saved ? saved : prefersDark ? "dark" : "light");

        btn.addEventListener("click", () => {
          const next =
            root.getAttribute("data-theme") === "dark" ? "light" : "dark";
          apply(next);
        });
      })();
    </script>
  </body>
</html>
